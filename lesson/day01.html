<html>
<head>
<title>Learn TI-83 Plus Assembly In 28 Days &mdash; Day 1 &mdash; Introduction</title>
<link rel="Stylesheet" href="../stuff/format.css">
</head>

<body>

<div class=NavHeader>
    &middot; <a href="toc.html">Table Of Contents</a>
    &middot; <a href="day02.html">Next</a>
    &middot;
</div>

    <hr>
    <h1>DAY 1. Introduction</h1>
    <hr>
    <b><font color=#006600>novice</font> <font color=#CCCCCC>intermediate advanced expert</font></b><hr>

<ul class=TopicList>
    TOC here.
</ul>
    <hr>
    
<a name="req"></a>
    <h2>Requirements for Learning</h2>
    <p>
    To learn assembly programming for the TI-83 Plus, you will require a few things.
    This lesson will guide you through setting up all the required tools and
    creating your first program.
    </p>

    <p>It is also highly recommended that you be fairly competent in any
    programming language. And when I say "any programming language", I mean, of
    course, C.  If z80 is your first venture into programming, many portions of
    this tutorial will be confusing.  I will use C as a kind of "pseudocode"
    from time to time, so if you know any kind of high-level language (with the
    definite exception of TI-BASIC) you should do okay.</p>

    <h2>Software</h2>
    In order to begin creating your own programs, you'll need a few tools on
    your computer.

    <h3>Assembler</h3>
    <p>
    The most important piece of software for building assembly programs is
    the assembler, which translates your code into a format that can be
    executed by the machine.
    <a href="http://www.ticalc.org/archives/files/fileinfo/15/1504.html">TASM</a>
    was the traditional choice, but it no longer works on modern operating
    systems, since it is a DOS program.  TASM also requires a separate
    program to 'link' the assembler's output- package it into a file that
    can be sent to a calculator (that is, a .8xp file).
    </p>
    <p>
    In this tutorial, we will use
    <a href="http://www.benryves.com/bin/brass/">Brass</a>, which is a more
    modern assembler capable of running on all major operating systems.  In
    addition, Brass can perform the linking step on its own, so we don't need
    any more programs.  The next section will guide you through setting up
    Brass on your operating system- simply select from the list below.
    </p>
    <p style="color:red">ED NOTE: OS autodetection from user agent expected here,
    with fallback to this list.</p>
    <span style="display:none">Your current OS has been automatically detected as 
        <span id="detectedOS">UNKNOWN</span>.
        If this is incorrect or you want to set things up on a different system,
        select the desired operating system from the list below.
    </span>
    <ul>
        <li><a href="#windows">Windows</a></li>
        <li><a href="#linux">Linux</a></li>
        <li><a href="#osx">Mac OS X</a></li>
    </ul>

    <h4 id="windows">Windows</h4>
    <h4 id="linux">Linux</h4>
    <h4 id="osx">Mac OS X</h4>

    <h3>Editor</h3>
    <p>For writing source code, you will need a text editor.  The source code is
    just plain text, so nearly any program will do.  Some common choices are
    given in the table below, with the supported operating systems for each.</p>

    <p style="color:red">ED NOTE: better styling of table TODO</p>
    <table>
        <tr><td>Name</td><td>Windows</td><td>Linux</td><td>Mac</td><td>Comments</td></tr>
        <tr>
            <td>Notepad</td>
            <td>X</td><td /><td />
            <td>Included with every installation of Windows, but not many features.</td>
        </tr>
        <tr>
            <td>Notepad++</td>
            <td>X</td><td /><td />
            <td>Lots of features, and easy to use.  Recommended for inexperienced
                programmers.</td>
        </tr>
        <tr>
            <td>Vim</td>
            <td>X</td><td>X</td><td>X</td>
            <td>The hacker's editor.  Extremely powerful, but has a very steep
                learning curve.</td>
        </tr>
    </table>
    <p style="color: red">ED NOTE: Editor recommendations welcome.</p>


    <h3>Emulator</h3>
    <p>Once you've written a program, you need a way to run it.  Simply transferring
    it to your calculator and running it there is one option (which we'll discuss later),
    but it becomes very hard to debug programs running on a calculator (and there
    will be bugs in your programs).  For that reason, we'll use an emulator, which is a
    program that runs on your computer and acts like a calculator would.</p>

    <p>Our emulator of choice here is <a href="https://wabbit.codeplex.com/">WabbitEmu</a>,
    as it is the best emulator that is still actively developed.</p>

    <span class="todo">Wabbit setup instructions here.</span>
    <span class="todo">ROM dumping instructions here.</span>

<table class=Info>
<tr>
    <td width=50%>TI-83 Plus Calculator</td>
    <td width=50%><a href="http://www.ticalc.org/archives/files/fileinfo/129/12922.html">DevPac8x</a> linker</td>
</tr>

<tr>
    <td>Graph Link cable with associated software</td>
    <td>TI83PLUS.INC file (included)</td>
</tr>

<tr>
    <td><a href="http://www.ticalc.org/archives/files/fileinfo/250/25051.html">TASM assembler</a></td>
    <td>TASM Z80 table file (<tt>tasm80.tab</tt>)</td>
</tr>
</table>


<a name="dev"></a>
    <h2>Creating your first program</h2>
    <p>Now that you've set up all the tools for building and testing programs,
    it's time to actually create one.  Create a new file with your text editor,
    and paste the following code into it.</p>

<div class=Program>
<pre>.nolist
#include "ti83plus.inc"
#define ProgStart $9D95
.list
.org ProgStart - 2
.db t2ByteTok, tAsmCmp

    b_call(_ClrLCDFull)
    ld a, 0
    ld (CurRow), a
    ld (CurCol), a
    ld hl, msg
    b_call(_PutS)            ; Display the text
    b_call(_NewLine)
    ret

msg:
    .db "Hello world!", 0
.end</pre>
</div>
<span class="todo">Discuss the potential optimizations: <code>xor a</code>,
    or <code>ld (CurRow), hl</code> after zeroing HL.</span>

<p>Save this file as hello.asm.  This should be easy if you're using a competent
editor, but some programs (notably Notepad) make it annoyingly difficult.
<span class="todo">Need more information on this for Windows users.</span>
</p>

<span class="todo">Hand-hold through invoking the assembler and running in the emulator.</span>
<br />

The first step is to create the source code in a text editor. Use Notepad for
this, because it saves its files in ASCII text format. As your programs get
more involved, it might be a good idea to switch to a specialized <a
    style="cursor: help" onClick="alert('Integrated Developer Environment:
    provides all the tools necessary to assemble a program with special treats
    like syntax coloring'); return false">IDE</a> (Crimson Editor is a good
one). When you save your source file, give it a name descriptive of its
function, and add a .z80 extension.<p>

There is a minor irritant we have to fix first, though: when you save your source file, Notepad will name it <tt>source.z80.txt</tt> because it's stupid enough to think it knows better than you. This is definitely not what you want. To fix this, follow these steps (Windows 98).
<ol>
    <li>Open Windows Explorer.
    <li>Click the View menu, and select Folder Options...
    <li>In the File Types tab, click New Type...
    <li>Fill out the fields like this:<br>
    <div align=center><img src="../img/ftype1.png" alt="[NO IMAGE]" width=440 height=149></div>
    <li>Click New... and fill out the fields like this:<br>
    <div align=center><img src="../img/ftype2.png" alt="[NO IMAGE]" width=459 height=161></div>
    <li>Click OK and Close.
</ol>

The next step in development is to transform the source code (called "assembling") into machine language that makes sense to the calculator, using a program called (of all things) an Assembler. The assembler we will be using is called TASM (this is not Borland's Turbo Assembler).<p>

Once the program is assembled, a linker is used to alter the machine language slightly in order
for the calculator to be able to read it. We will be using a linker called DevPac8x.<p>

Finally, you ship the program to the calculator and run it.<p>

<a name="asm"></a>
    <h2>Assembling</h2>
If you didn't do it while you were viewing the readme file, create a new folder off the C:\ drive and call it <tt>Asm</tt>. In this folder create three new folders:

<table class=Info>
<tr>
    <td class=Heading width=20%><tt>Source</tt></td>
    <td>Put your source files here</td>
</tr>
<tr>
    <td class=Heading><tt>Tasm</tt></td>
    <td>Put <tt>TASM.EXE, TASM80.TAB, TI83PLUS.INC, DEVPAC8X.COM </tt>here</td>
</tr>
<tr>
    <td class=Heading><tt>Exec</tt></td>
    <td>Look here for compiled programs</td>
</tr>
</table>
    
In the <tt>Tasm</tt> folder, make a new text file and type in this:

<div class=Program>
<pre>@echo off
echo ==== Now assembling %1.z80 for the TI-83 Plus ====
tasm -80 -i -b c:\asm\source\%1.z80 c:\asm\exec\%1.bin
if errorlevel 1 goto ERRORS
rem This is necessary because of a DevPac8x bug
cd c:\asm\exec
c:\asm\tasm\devpac8x %1
cd c:\asm\tasm
echo ==== Job finished. Program saved as %1.8xp ====
goto DONE
:ERRORS
echo ==== Errors!!! ====
:DONE
del c:\asm\source\%1.lst > NUL
del c:\asm\exec\%1.bin > NUL
echo ==== Done ====</pre></div>

And save as <tt>asm.bat</tt>. What you just made is called a batch file and is similar in purpose to TI-BASIC programs.<p>

<a name="pgm"></a>
    <h2>Sample Z80 Program</h2>
Now to make sure that everything has been set up satisfactorialy, we are going to write, assemble, link, and send a little do-nothing program.  Enter the following source code and don't bother trying to understand it... yet.


And save as <tt>hello.z80</tt> in the <tt>source</tt> directory<br>
to compile, open up DOS (try Start menu, Run, then whichever of <tt>command.com</tt> or <tt>cmd.exe</tt> works) and go to the TASM directory. Type <tt>asm hello</tt> and press Enter.<p>

After a second or two (or more, depending on your computer's speed), assembly will finish, and
the program is ready to be transmitted to the calculator.<p>

<a name="dos"></a>
    <h3>Navigating Within DOS</h3>
Since Windows completely replaced DOS as the operating system for PCs, most newer computer users will be at somewhat of a loss when confronted with the DOS command prompt. Here are a few things about DOS that you will find helpful when navigating through your directory structure. I presume that you have enough experience with file managers like Explorer to know what things like "subdirectory" and "parent directory" mean.<p>

<dl>
    <dt>Command Prompt</dt>
    <dd>At the extreme left of the screen is the command prompt. This is the name of the
current drive, current directory, and all parent directories. The format of internet URLs are directly based on the command prompt (although not specifically the DOS prompt), so you shouldn't have any trouble interpreting it.<p>

    <dt><tt>cd <i>directory</i></tt>
    <dd>Changes the current directory. The directory changed to must be a subdirectory of the
    current one.<p>

    <dt><tt>cd ..</tt>
    <dd>Moves to the parent directory of the current directory.<p>

    <dt><tt>cd \</tt>
    <dd>Moves to the root directory.<p>

    <dt><tt>dir /p</tt>
    <dd>Displays a list of all files in the current directory. Useful for getting your
    bearings.
</dl><p>

<a name="lnk"></a>
    <h2>Sending to the Calculator</h2>
Start the Graph Link software. Other programs like TI-Connect I am unfamiliar with and cannot give any help. Click on <tt><u>L</u>ink</tt>, <tt><u>S</u>end To ></tt>, then <tt><u>R</u>AM</tt>. Navigate to the <tt>C:\Asm\Exec</tt> folder and send <tt>hello.8xp</tt> over.<p>

To run the program, paste <tt>Asm(</tt> from the catalog and <tt>HELLO</tt> from the PRGM menu...<p>

And you should get this:
<div align=center><img src="../img/hello.png" alt="[NO IMAGE]" width=300 height=204></div>

GAHHHHHHHHHHHHHHHHHHH! Okay, so maybe I <i>don't</i> have a creative bone in my body :-) but, if
the screen went blank, it means that there's an error in the program that's caused the calculator 
to crash. All you can do is turn the calculator back on and be greeted by a "RAM Cleared" message, which means exactly what you think it does. <a href="../ref/crash.html" target=_blank>Crashes</a> wipe out the RAM and reset the calculator's defaults (fortunately, archived variables are safe). Go back to the "Sample Z80 Program" section and try again.<p>

    <h2>One Last Important Thing</h2>
Assembly programs for the TI-83 Plus cannot be more than 8811 bytes in size. Well they can, but just keep them below that.

    <hr>
<div class=NavFooter>
    <a href="day02.html">NEXT - Day 2: The Components of a Z80 Program</a><p>
    <a href="toc.html">Table Of Contents</a>
</div>
    <hr>
<address>
This is part of Learn TI-83 Plus Assembly In 28 Days<br>
Copyright (c) 2002, 2003, 2004 Sean McLaughlin<br>
See the file gfdl.html for copying conditions
</address>
<hr>

</body>
</html>
